{% extends "base.html" %}

{% block title %}Scan Result - Gym Manager{% endblock %}

{% block content %}
<div style="max-width: 500px; margin: 0 auto; text-align: center; padding-top: 2rem;">

    {% if status == 'GRANTED' %}
    <div
        style="background: #2ecc71; color: white; padding: 2rem; border-radius: 16px; box-shadow: 0 10px 30px rgba(46, 204, 113, 0.4); animation: popIn 0.5s ease-out;">
        <div style="font-size: 5rem; margin-bottom: 1rem;">‚úÖ</div>
        <h1 style="font-size: 2.5rem; font-weight: 800; margin: 0;">ACCESS GRANTED</h1>
        <p style="font-size: 1.2rem; opacity: 0.9;">Paid for {{ month }}</p>
    </div>
    {% elif status == 'TRIAL' %}
    <div
        style="background: #3498db; color: white; padding: 2rem; border-radius: 16px; box-shadow: 0 10px 30px rgba(52, 152, 219, 0.4); animation: popIn 0.5s ease-out;">
        <div style="font-size: 5rem; margin-bottom: 1rem;">‚è≥</div>
        <h1 style="font-size: 2.5rem; font-weight: 800; margin: 0;">TRIAL ACCESS</h1>
        <p style="font-size: 1.2rem; opacity: 0.9;">Trial Active</p>
    </div>
    {% else %}
    <div
        style="background: #e74c3c; color: white; padding: 2rem; border-radius: 16px; box-shadow: 0 10px 30px rgba(231, 76, 60, 0.4); animation: shake 0.5s ease-in-out;">
        <div style="font-size: 5rem; margin-bottom: 1rem;">‚õî</div>
        <h1 style="font-size: 2.5rem; font-weight: 800; margin: 0;">ACCESS DENIED</h1>
        <p style="font-size: 1.2rem; opacity: 0.9;">Not Paid for {{ month }}</p>
    </div>
    {% endif %}

    <div class="card" style="margin-top: 2rem;">
        {% if member.photo %}
        <img src="{{ url_for('static', filename='uploads/' + member.photo) }}"
            style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid var(--border); margin: 0 auto 1rem auto; display: block;">
        {% else %}
        <div
            style="width: 150px; height: 150px; border-radius: 50%; background: var(--primary); color: white; font-size: 4rem; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem auto;">
            {{ member.name[0] }}
        </div>
        {% endif %}

        <h2>{{ member.name }}</h2>
        <p style="color: var(--text-muted);">ID: {{ member.id }}</p>
        <p><strong>Phone:</strong> {{ member.phone }}</p>

        <div style="margin-top: 2rem; display: grid; gap: 1rem;">
            {% if status == 'DENIED' %}
            <a href="{{ url_for('member_details', member_id=member.id) }}" class="btn btn-success"
                style="font-size: 1.2rem; padding: 1rem;">
                üí∞ Collect Payment
            </a>
            {% endif %}

            <a href="{{ url_for('scanner') }}" class="btn btn-secondary">
                üì∑ Scan Next
            </a>
            <a href="{{ url_for('dashboard') }}" class="btn">
                üè† Dashboard
            </a>
        </div>
    </div>

    <!-- Attendance History -->
    {% if attendance_history %}
    <div class="card" style="margin-top: 2rem;">
        <h3 style="margin-bottom: 1rem; color: var(--primary); font-size: 1.3rem;">üìä Recent Attendance</h3>
        <div style="max-height: 300px; overflow-y: auto;">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for visit in attendance_history[:10] %}
                    <tr>
                        <td>{{ visit.split()[0] }}</td>
                        <td>{{ visit.split()[1] if visit.split()|length > 1 else 'N/A' }}</td>
                        <td><span class="badge paid">‚úì Checked In</span></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div style="text-align: center; margin-top: 1rem; color: var(--text-muted); font-size: 0.9rem;">
            Total Visits: {{ attendance_history|length }}
        </div>
    </div>
    {% endif %}
</div>

<style>
    @keyframes popIn {
        0% {
            transform: scale(0.8);
            opacity: 0;
        }

        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    @keyframes shake {

        0%,
        100% {
            transform: translateX(0);
        }

        10%,
        30%,
        50%,
        70%,
        90% {
            transform: translateX(-5px);
        }

        20%,
        40%,
        60%,
        80% {
            transform: translateX(5px);
        }
    }
</style>
{% endblock %}